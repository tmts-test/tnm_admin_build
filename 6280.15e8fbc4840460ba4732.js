"use strict";(self.webpackChunktnm_front_admin=self.webpackChunktnm_front_admin||[]).push([[6280],{6280:(e,t,r)=>{r.r(t),r.d(t,{default:()=>A});var n=r(525),a=r(6038),s=r(6869),l=r(5788),o=r(7158),u=r(3904),c=r(4378),m=r(6071),i=r(966),d=r(8509);var p=r(8557),f=r(4869),h=r(6997),b=Object.defineProperty,x=Object.getOwnPropertySymbols,y=Object.prototype.hasOwnProperty,g=Object.prototype.propertyIsEnumerable,E=(e,t,r)=>t in e?b(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,v=(e,t)=>{for(var r in t||(t={}))y.call(t,r)&&E(e,r,t[r]);if(x)for(var r of x(t))g.call(t,r)&&E(e,r,t[r]);return e},w=(e,t,r)=>new Promise(((n,a)=>{var s=e=>{try{o(r.next(e))}catch(e){a(e)}},l=e=>{try{o(r.throw(e))}catch(e){a(e)}},o=e=>e.done?n(e.value):Promise.resolve(e.value).then(s,l);o((r=r.apply(e,t)).next())}));const A=function(){const{login:e}=(0,o.A)(),t=(0,a.Zp)(),{auth:r,setInfo:b,setMenu:x,setMenuRoot:y,setAuth:g}=(0,p.A)(),[E,A]=(0,n.useState)(!1),[I,N]=(0,n.useState)(!1),{register:k,watch:S,setError:V,setFocus:O,formState:{errors:T},handleSubmit:U}=(0,l.mN)({mode:"onSubmit",defaultValues:{username:"",password:""}}),j=S("username"),C=S("password"),{data:M,refetch:P}=(0,d.I)({queryKey:["/adm/auth/member/info"],enabled:!1}),{data:q,refetch:z}=(0,d.I)({queryKey:["/adm/auth/menu/list"],enabled:!1});(0,n.useEffect)((()=>{var e=h.A.getItem("loginStoreCheck"),r=h.A.getItem("auth");if(null!==e&&"Y"===e&&(g({isAuthenticated:!1,accessToken:null,refreshToken:null}),h.A.removeItem("loginStoreCheck")),null!==r){const e=JSON.parse(r||"").accessToken,s=JSON.parse(r||"").refreshToken;g({isAuthenticated:!0,accessToken:e,refreshToken:s});var n=h.A.getItem("menu");if(n){var a=JSON.parse(n||"").authMenu;"/notification"===a[0].path?t(a[0].path):t(a[0].childrens[0].path)}}else h.A.removeItem("menu"),h.A.removeItem("info")}),[]),(0,n.useEffect)((()=>{O("username"),O("password")}),[O]),(0,n.useEffect)((()=>{if("200100"===(null==M?void 0:M.code)&&r.isAuthenticated){b(M.result.signInInfo),h.A.setItem("info",JSON.stringify(M.result.signInInfo));const e=null==q?void 0:q.result.authMenuList;e&&x(e),D(M.result.signInInfo.lstPwdModDtm)?e&&("/notification"===e[0].menuUrlVal&&(y(e[0].menuUrlVal),t(e[0].menuUrlVal)),y(e[1].menuUrlVal),t(e[1].menuUrlVal)):N(!0)}}),[E]);const D=e=>{if(null===e){const e=null==q?void 0:q.result.authMenuList;return e&&("/notification"===e[0].menuUrlVal&&y(e[0].menuUrlVal),y(e[1].menuUrlVal)),t("/password"),!1}const r=new Date,n=new Date(e);return!((r.getTime()-n.getTime())/864e5>=90)},J=()=>w(this,null,(function*(){try{s.A.put("/adm/auth/member/change-password-after").then((e=>{if(200===e.status){const e=null==q?void 0:q.result.authMenuList;e&&("/notification"===e[0].menuUrlVal&&t(e[0].menuUrlVal),t(e[1].menuUrlVal))}}))}catch(e){console.log(e)}}));return n.createElement(n.Fragment,null,n.createElement("div",{className:"flex justify-center items-center w-full h-screen"},n.createElement("form",{onSubmit:U((t=>w(this,null,(function*(){if(!f.TO.test(j))return void V("username",{message:"\uc544\uc774\ub514 \ub610\ub294 \ube44\ubc00\ubc88\ud638\ub97c \ud655\uc778\ud574\uc8fc\uc138\uc694"});if(!f.kW.test(C))return void V("password",{message:"\uc544\uc774\ub514 \ub610\ub294 \ube44\ubc00\ubc88\ud638\ub97c \ud655\uc778\ud574\uc8fc\uc138\uc694"});200===(yield e(t)).status&&(yield P(),yield z(),A(!E))}))))},n.createElement("div",{className:"border-4 rounded-[30px] border-tp-100 mb-4 px-[40px] pt-[46px] pb-[36px]"},n.createElement("div",{className:"w-[514px] border-b-2 border-tg-140 pb-[20px]"},n.createElement(u.A,{icon:"logo"})),n.createElement("div",{className:"flex flex-col gap-2.5 px-[24px] pt-[30px] pb-[40px]"},n.createElement(c.A,v({type:"text",size:"md",isError:T.username,placeholder:"ID"},k("username",{required:!0}))),n.createElement(c.A,v({type:"password",size:"md",isError:T.password,placeholder:"PW"},k("password",{required:!0}))),T.username&&n.createElement("span",{className:"text-body4 text-color-alert text-center"},T.username.message),T.password&&n.createElement("span",{className:"text-body4 text-color-alert text-center"},T.password.message)),n.createElement("span",{className:"flex justify-center"},n.createElement(m.A,{type:"submit"},"Login"))),n.createElement("span",{className:"flex justify-center text-xs text-tg-100"},"Copyright\xa9 Tmoney . All rights reserved."))),n.createElement(i.A,{isShow:I},n.createElement("div",null,n.createElement("h3",{className:"font-Tmoney text-headline1 leading-10 mb-[10px] text-center"},"\ube44\ubc00\ubc88\ud638 \ubcc0\uacbd \uc548\ub0b4"),n.createElement("p",{className:"text-body1 leading-6 mb-[40px]"},"90\uc77c \uc774\uc0c1 \ub3d9\uc77c\ud55c \ube44\ubc00\ubc88\ud638\ub97c \uc0ac\uc6a9\ud558\uace0 \uc788\uc2b5\ub2c8\ub2e4",n.createElement("br",null),"\uac1c\uc778\uc815\ubcf4 \ubcf4\ud638\ub97c \uc704\ud574 \ube44\ubc00\ubc88\ud638\ub97c \ubcc0\uacbd\ud574 \uc8fc\uc138\uc694"),n.createElement("div",{className:"flex gap-[30px] justify-center"},n.createElement(m.A,{type:"button",color:"secondary",size:"lg",onClick:()=>J()},"\ub2e4\uc74c\uc5d0 \ubcc0\uacbd"),n.createElement(m.A,{type:"button",size:"lg",onClick:()=>t("/password")},"\ube44\ubc00\ubc88\ud638 \ubcc0\uacbd")))))}}}]);