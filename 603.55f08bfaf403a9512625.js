"use strict";(self.webpackChunktnm_front_admin=self.webpackChunktnm_front_admin||[]).push([[603],{603:(e,t,r)=>{r.r(t),r.d(t,{default:()=>v});var n=r(9352),a=r(4668),l=r(5038),s=r(7502),o=r(6051),c=r(5633),m=r(2697),u=r(1006),i=r(7345),d=r(9379);var p=r(5176),f=r(8834),h=Object.defineProperty,g=Object.getOwnPropertySymbols,b=Object.prototype.hasOwnProperty,x=Object.prototype.propertyIsEnumerable,y=(e,t,r)=>t in e?h(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,E=(e,t)=>{for(var r in t||(t={}))b.call(t,r)&&y(e,r,t[r]);if(g)for(var r of g(t))x.call(t,r)&&y(e,r,t[r]);return e},w=(e,t,r)=>new Promise(((n,a)=>{var l=e=>{try{o(r.next(e))}catch(e){a(e)}},s=e=>{try{o(r.throw(e))}catch(e){a(e)}},o=e=>e.done?n(e.value):Promise.resolve(e.value).then(l,s);o((r=r.apply(e,t)).next())}));const v=function(){const{login:e}=(0,o.A)(),t=(0,a.Zp)(),{auth:r,setInfo:h,setMenu:g,setMenuRoot:b}=(0,p.A)(),[x,y]=(0,n.useState)(!1),[v,I]=(0,n.useState)(!1),{register:S,watch:A,setError:N,setFocus:V,formState:{errors:k},handleSubmit:U}=(0,s.mN)({mode:"onSubmit",defaultValues:{username:"",password:""}}),j=A("username"),O=A("password"),{data:C,refetch:P}=(0,d.I)({queryKey:["/adm/auth/member/info"],enabled:!1}),{data:T,refetch:M}=(0,d.I)({queryKey:["/adm/auth/menu/list"],enabled:!1});(0,n.useEffect)((()=>{V("username"),V("password")}),[V]);const{setAuth:q}=(0,p.A)();(0,n.useEffect)((()=>{if(localStorage.removeItem("menu"),localStorage.removeItem("info"),"Y"===localStorage.getItem("loginStoreCheck")&&(q({isAuthenticated:!1,accessToken:null,refreshToken:null}),localStorage.removeItem("loginStoreCheck")),"200100"===(null==C?void 0:C.code)&&r.isAuthenticated){h(C.result.signInInfo),localStorage.setItem("info",JSON.stringify(C.result.signInInfo));const e=null==T?void 0:T.result.authMenuList;e&&g(e),z(C.result.signInInfo.lstPwdModDtm)?e&&("/notification"===e[0].menuUrlVal&&(t(e[0].menuUrlVal),b(e[0].menuUrlVal)),t(e[1].menuUrlVal),b(e[1].menuUrlVal)):I(!0)}}),[x]);const z=e=>{if(null===e){const e=null==T?void 0:T.result.authMenuList;return e&&("/notification"===e[0].menuUrlVal&&b(e[0].menuUrlVal),b(e[1].menuUrlVal)),t("/password"),!1}const r=new Date,n=new Date(e);return!((r.getTime()-n.getTime())/864e5>=90)},D=()=>w(this,null,(function*(){try{l.A.put("/adm/auth/member/change-password-after").then((e=>{if(200===e.status){const e=null==T?void 0:T.result.authMenuList;e&&("/notification"===e[0].menuUrlVal&&t(e[0].menuUrlVal),t(e[1].menuUrlVal))}}))}catch(e){console.log(e)}}));return n.createElement(n.Fragment,null,n.createElement("div",{className:"flex justify-center items-center w-full h-screen"},n.createElement("form",{onSubmit:U((t=>w(this,null,(function*(){f.TO.test(j)?f.kW.test(O)?(yield e(t),yield P(),yield M(),y(!x)):N("password",{message:"\uc544\uc774\ub514 \ub610\ub294 \ube44\ubc00\ubc88\ud638\ub97c \ud655\uc778\ud574\uc8fc\uc138\uc694"}):N("username",{message:"\uc544\uc774\ub514 \ub610\ub294 \ube44\ubc00\ubc88\ud638\ub97c \ud655\uc778\ud574\uc8fc\uc138\uc694"})}))))},n.createElement("div",{className:"border-4 rounded-[30px] border-tp-100 mb-4 px-[40px] pt-[46px] pb-[36px]"},n.createElement("div",{className:"w-[514px] border-b-2 border-tg-140 pb-[20px]"},n.createElement(c.A,{icon:"logo"})),n.createElement("div",{className:"flex flex-col gap-2.5 px-[24px] pt-[30px] pb-[40px]"},n.createElement(m.A,E({type:"text",size:"md",isError:k.username,placeholder:"ID"},S("username",{required:!0}))),n.createElement(m.A,E({type:"password",size:"md",isError:k.password,placeholder:"PW"},S("password",{required:!0}))),k.username&&n.createElement("span",{className:"text-body4 text-color-alert text-center"},k.username.message),k.password&&n.createElement("span",{className:"text-body4 text-color-alert text-center"},k.password.message)),n.createElement("span",{className:"flex justify-center"},n.createElement(u.A,{type:"submit"},"Login"))),n.createElement("span",{className:"flex justify-center text-xs text-tg-100"},"Copyright\xa9 Tmoney . All rights reserved."))),n.createElement(i.A,{isShow:v},n.createElement("div",null,n.createElement("h3",{className:"font-Tmoney text-headline1 leading-10 mb-[10px] text-center"},"\ube44\ubc00\ubc88\ud638 \ubcc0\uacbd \uc548\ub0b4"),n.createElement("p",{className:"text-body1 leading-6 mb-[40px]"},"90\uc77c \uc774\uc0c1 \ub3d9\uc77c\ud55c \ube44\ubc00\ubc88\ud638\ub97c \uc0ac\uc6a9\ud558\uace0 \uc788\uc2b5\ub2c8\ub2e4",n.createElement("br",null),"\uac1c\uc778\uc815\ubcf4 \ubcf4\ud638\ub97c \uc704\ud574 \ube44\ubc00\ubc88\ud638\ub97c \ubcc0\uacbd\ud574 \uc8fc\uc138\uc694"),n.createElement("div",{className:"flex gap-[30px] justify-center"},n.createElement(u.A,{type:"button",color:"secondary",size:"lg",onClick:()=>D()},"\ub2e4\uc74c\uc5d0 \ubcc0\uacbd"),n.createElement(u.A,{type:"button",size:"lg",onClick:()=>t("/password")},"\ube44\ubc00\ubc88\ud638 \ubcc0\uacbd")))))}}}]);